---
layout: post
title: "指针"
subtitle: '指针'
comments: false
author: "Gump"
header-style: text
date: 2018-02-11 20:30:21 +0800
tags:
    - C/C++
    - 笔记
---

# 指针
## 1、直接引用
    char a='A';
通过变量名引用变量，由系统自动完成变量名和变量地址直接的转换，称为变量的”直接引用“方式
（a是我们对那个整形变量的4个字节取的"名字",是我们人为给的,实际上计算机并不存储a这个名字,只是我们编程时给那4个字节内存取个名字好用.
实际上程序在编译时,所有的a都转换为了那个地址空间了.编译成机器代码后,没有a这个说法了.a这个名字只存在于我们编写的代码中）

## 2、间接引用
间接引用：首先将变量a的地址存放在另一个变量中，比如放在变量b中，然后通过变量来间接引用变量，间接读取变量a的值，这就是“间接引用”
变量
地址
值
a
fff1
0100 0001
b
fff2
fff1

总结：存储变量地址的变量就是“指针变量” 如 b就是指针变量
char a='B';
//声明一个指针变量b，而且b只能够指向char类型的变量
char *b;  //这里的*代表b是一个指针变量
//将b指向a变量
b=&a;
//改变变量a的值
*b='C'；//这里的* 代表找到b中存储地址的存储空间

## 3、指针与字符串
char *p;
char a[]="mlj";
p=a;
此时字符串是个变量，a[0]='a'是正确的

char *p="mlj"

此时字符串是个常量，*p='a';是错误的，不能改变字符串的值

输出方式
printf("%s",p)
四、指向函数的指针
int sum(a,b)(函数名代表函数的地址)

int (*p)(int,int);
p=sum;

通过函数指针调用所指向的函数
(*p)(1,2)
p(1,2)

用途：通过函数指针可以把函数当做参数传递
如 int count(int a,int b,int (*p)(int,int))
        {
            p(a,b);
        }
调用：count(a,2,sum);



## 4.数组做函数参数，会退化为指针
## 5.sizeof(*p) 指针的大小 是指针变量占用内存的大小 
如：
int *p;
sizeof(*p)=sizeof(int)=4;
char a[10];
sizeof(*a)=sizeof(char)=1;
sizeof(a)=10;
*a代表数组a第一个元素的地址
3.形参中类型char a[10]的参数，会退化为指针
        证据：
        char a[10]={.....};
        sizeof(a)=10;
        void test(char a[10])
        {
            sizeof(a)=1;
        }
## 6.void*  是说: 这是一个指针,它指向的对象未知.
   void**  是说: 这是一个指针,它指向一个void* 型的数据结构.

## 7.栈（临时内存空间）的生长方向向下，堆（全局内存空间，new malloc来申请得到）的生长方向向上
    char *p1="sda";
    char *p2="edfs";
    &p1>&p2;(p1,p2放在栈里)
    char *p3=(char *)malloc(10);
    char *p4=(char *)malloc(10);

## 8.指针的数据类型是它所指向内存空间的类型，指针数据类型具有依赖性；

结论：指针的步长根据其所指向的内存空间类型来定

## 9.指针的用途及最大意义
  场景1：在函数内 *p1++=*p2++;指针变量 操作
  场景2：指针做函数参数，通过*p形参改变实参的值，这才是指针的最大意义
用1级指针（通常是形参），修改0级指针（通常是实参）的值；
用2级指针（通常 是形参），修改1级指针（通常是实参）的值；
用3级指针（通常是形参），修改2级指针（通常是实参）的值；
用n级指针（通常是形参），修改n-1级指针（通常是实参）的值；
函数调用时，形参传给实参，用实参来取地址，传给形参；在被调用函数里用*p，来改变实参，把运算结果传出来

## 10.作为函数参数时的等价关系（数据作为函数参数会退化为指针：高效）
数组                                                指针
一维数组 char a[30]                        指针            char *a;
指针数组 char *a[30]                       指针的指针  char **a;  
二维数组 char[10][30]                     数组的指针  char (*a)[30]

如何区分指针数组和数组指针：char *a[30] []的优先级较高 所以a为数组名，指针类型的数组，即指针数组
                                                 char (*a)[30] ()[]的优先级相等，遵循由左到右的原则，所以 a是指针，指向数组，即数组指针

## 11.避免野指针的方法；
 第一步、初始化的时候初始化为NULL
    char *p=NULL;
    p=mallc(10);
第二步、释放的时候判断是否是NULL
 if(p!=NULL)
{
    free(p);
}
第三步、释放完毕在置成NUILL
p=NULL;
## 12.结构体变量四字节存放
typeof struct _Teacher
{
    char name[6];
    int age;
} Teacher
Teacher t;
sizeof(t)=12;//name 为6 ，其实一共分配了8 ，剩余两位不够int用，空了出来，所以8+4

typeof struct _Teacher
{
    char name[6];
    char age;
} Teacher
Teacher t;
sizeof(t)=7; //剩余两位够char用了