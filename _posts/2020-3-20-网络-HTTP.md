---
layout: post
title: "http协议"
subtitle: ''
comments: false
author: "Gump"
header-style: text
date: 2020-3-20 20:30:21 +0800
tags:
    - 网络
    - 笔记
    - http
---

# HTTP 协议



## 跨域

## 造成跨域的原因

浏览器的同源策略会导致跨域，这里同源策略又分为以下两种

1. DOM同源策略：禁止对不同源页面DOM进行操作。这里主要场景是iframe跨域的情况，不同域名的iframe是限制互相访问的。
2. XmlHttpRequest同源策略：禁止使用XHR对象向不同源的服务器地址发起HTTP请求

### 浏览器为什么要限制跨域

AJAX同源策略主要用来防止CSRF攻击。如果没有AJAX同源策略，相当危险，我们发起的每一次HTTP请求都会带上请求地址对应的cookie，那么可以做如下攻击：

1. 用户登录了自己的银行页面 [http://mybank.com](https://link.zhihu.com/?target=http%3A//mybank.com)，[http://mybank.com](https://link.zhihu.com/?target=http%3A//mybank.com)向用户的cookie中添加用户标识。
2. 用户浏览了恶意页面 [http://evil.com](https://link.zhihu.com/?target=http%3A//evil.com)。执行了页面中的恶意AJAX请求代码。
3. [http://evil.com](https://link.zhihu.com/?target=http%3A//evil.com)向[http://mybank.com](https://link.zhihu.com/?target=http%3A//mybank.com)发起AJAX HTTP请求，请求会默认把[http://mybank.com](https://link.zhihu.com/?target=http%3A//mybank.com)对应cookie也同时发送过去。
4. 银行页面从发送的cookie中提取用户标识，验证用户无误，response中返回请求数据。此时数据就泄露了。
5. 而且由于Ajax在后台执行，用户无法感知这一过程

DOM同源策略也一样，如果iframe之间可以跨域访问，可以这样攻击：

1. 做一个假网站，里面用iframe嵌套一个银行网站 [http://mybank.com](https://link.zhihu.com/?target=http%3A//mybank.com)。
2. 把iframe宽高啥的调整到页面全部，这样用户进来除了域名，别的部分和银行的网站没有任何差别。
3. 这时如果用户输入账号密码，我们的主网站可以跨域访问到[http://mybank.com](https://link.zhihu.com/?target=http%3A//mybank.com)的dom节点，就可以拿到用户的输入了，那么就完成了一次攻击。

### 跨域解决方案

- JSONP（过时）

- CORS - w3c推的标准


## HTTP1.0/HTTP1.1/HTTP2.0

### HTTP1.0

特性：默认短连接，服务端响应完即关闭TCP连接；

缺点：每次HTTP请求都需要新建TCP,耗时久

### HTTP1.1

特性：默认长连接

缺点：报文是文本，只能顺序发送；一个TCP连接只能同时处理一个HTTP请求；chrome浏览器支持最多同时开6个TCP请求

### HTTP2.0

特性：一条TCP长连接，多路复用